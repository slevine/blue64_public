<!DOCTYPE html>
<!--
    So Simple Jekyll Theme 3.2.0
    Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/so-simple-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  

  
    
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>A little Salt with that Hash? | Steven Levine</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="A little Salt with that Hash?" />
<meta name="author" content="Steven Levine" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Was just presented with a unique (to me) requirement which is to implement a single sign on across multiple domains within the same page via a cookie. Huh? Let me elaborate, in simple terms it means that there is a base site, lets call it foo.com, and then there is a partner site, lets call it bar.com. On foo.com’s main page we want to be able to iFrame in bar.com with the credentials of the current user logged in to foo.com transparently sent over and in turn logged in to bar.com as well." />
<meta property="og:description" content="Was just presented with a unique (to me) requirement which is to implement a single sign on across multiple domains within the same page via a cookie. Huh? Let me elaborate, in simple terms it means that there is a base site, lets call it foo.com, and then there is a partner site, lets call it bar.com. On foo.com’s main page we want to be able to iFrame in bar.com with the credentials of the current user logged in to foo.com transparently sent over and in turn logged in to bar.com as well." />
<link rel="canonical" href="https://stevenlevine.dev/2008/10/a-little-salt-with-that-hash/" />
<meta property="og:url" content="https://stevenlevine.dev/2008/10/a-little-salt-with-that-hash/" />
<meta property="og:site_name" content="Steven Levine" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-10-30T19:06:09+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="A little Salt with that Hash?" />
<script type="application/ld+json">
{"description":"Was just presented with a unique (to me) requirement which is to implement a single sign on across multiple domains within the same page via a cookie. Huh? Let me elaborate, in simple terms it means that there is a base site, lets call it foo.com, and then there is a partner site, lets call it bar.com. On foo.com’s main page we want to be able to iFrame in bar.com with the credentials of the current user logged in to foo.com transparently sent over and in turn logged in to bar.com as well.","@type":"BlogPosting","headline":"A little Salt with that Hash?","dateModified":"2008-10-30T19:06:09+00:00","datePublished":"2008-10-30T19:06:09+00:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://stevenlevine.dev/images/site-logo.png"},"name":"Steven Levine"},"url":"https://stevenlevine.dev/2008/10/a-little-salt-with-that-hash/","mainEntityOfPage":{"@type":"WebPage","@id":"https://stevenlevine.dev/2008/10/a-little-salt-with-that-hash/"},"author":{"@type":"Person","name":"Steven Levine"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/skins/default.css">
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,400i,700,700i|Roboto:400,400i,700,700i">
  <link rel="alternate" type="application/atom+xml" title="Steven Levine" href="/feed.xml">
<!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

</head>


  <body class="layout--post  a-little-salt-with-that-hash">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    
  <div class="navigation-wrapper">
    <a href="#menu-toggle" id="menu-toggle">Menu</a>
    <nav id="primary-nav" class="site-nav animated drop">
      <ul><li><a href="/about/">About</a></li><li><a href="/archives/">Archives</a></li><li><a href="/tags/">Tags</a></li><li><a href="/search/">Search</a></li></ul>
    </nav>
  </div><!-- /.navigation-wrapper -->


    <header class="masthead">
  <div class="wrap">
    
      <a href="/" class="site-logo" rel="home" title="Steven Levine">
        <img src="/images/site-logo.png" class="site-logo-img animated fadeInDown" alt="Steven Levine">
      </a>
    
    
    
      
        <div class="site-title animated fadeIn"><a href="/">Steven Levine</a></div>
      
      <p class="site-description animated fadeIn" itemprop="description">Working at Google Cloud, Hacker, Programmer, Cycling Geek, Scala Enthusiast,  who is fascinated with all things Data, Cloud, and Internet Scale.</p>
    
  </div>
</header><!-- /.masthead -->


    <main id="main" class="main-content" aria-label="Content">
  <article class="h-entry">
    

    <div class="page-wrapper">
      <header class="page-header">
        
        
          <h1 id="page-title" class="page-title p-name">A little Salt with that Hash?
</h1>
        
      </header>

      <div class="page-sidebar">
        <div class="page-author h-card p-author"><img src="/images/author.jpg" class="author-avatar u-photo" alt="Steven Levine"><div class="author-info"><div class="author-name">
        <span class="p-name">Steven Levine</span>
      </div><ul class="author-links"><li class="author-link">
            <a class="u-url" rel="me" href="https://github.com/slevine"><i class="fab fa-github-square fa-lg" title="GitHub"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="<a rel="me" href="https://data-folks.masto.host/@stevenlevine">Mastodon</a>"><i class="fab fa-mastodon fa-lg" title="Mastodon"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://twitter.com/_stevenlevine"><i class="fab fa-twitter-square fa-lg" title="Twitter"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://www.linkedin.com/in/levinesteve/"><i class="fab fa-linkedin fa-lg" title="LinkedIn"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://stackoverflow.com/users/63013/steven-levine"><i class="fab fa-stack-overflow fa-lg" title="StackOverflow"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://medium.com/@_stevenlevine"><i class="fab fa-medium fa-lg" title="Medium"></i></a>
          </li></ul>

<span class="read-time">3 min read</span>

    <time class="page-date dt-published" datetime="2008-10-30T19:06:09+00:00"><a class="u-url" href="">October 30, 2008</a>
</time>

  </div>
</div>

        

        
  <h3 class="page-taxonomies-title">Tags</h3>
  <ul class="page-taxonomies"><li class="page-taxonomy"><a href="/tags/#development" title="Pages tagged Development" rel="tag">Development</a></li><li class="page-taxonomy"><a href="/tags/#java" title="Pages tagged Java" rel="tag">Java</a></li>
  </ul>


      </div>

      <div class="page-content">
        <div class="e-content">
          <p>Was just presented with a unique (to me) requirement which is to
implement a single sign on across multiple domains within the same
page via a cookie. Huh? Let me elaborate, in simple terms it means
that there is a base site, lets call it foo.com, and then there is
a partner site, lets call it bar.com. On foo.com’s main page we
want to be able to iFrame in bar.com with the credentials of the
current user logged in to foo.com transparently sent over and in
turn logged in to bar.com as well.</p>

<p>In order to achieve this, the
first thing that needs to happen is the two sites need to have a
sub domain in common. The easiest way to accomplish this is to set
up an alias on the parent site (foo.com) to bar.com. The alias
would be something like bar.foo.com which points to bar.com. This
is required because if they do not have a domain in common there is
no way for them to share cookies.</p>

<p>The next thing that needs to
happen is both sites have to agree on a way of authenticating a
user. In our case we used a cookie that consisted of the user id
followed by a hash of the user id which looked something like
<code class="language-plaintext highlighter-rouge">12345,jfk83jf835jfiie43</code>.</p>

<p>Your probably wondering how this simple
cookie can facility a single sign on across two different sites?
Let me explain, first lets talk about the how the values of the
cookie are generated. The first value, namely, the user id, is self
explanatory. The second part of the cookie, the hash, has a little
bit more to it. In order to effectively use the hash, the two sites
need to have a “shared secret” aka “The Salt” that only they know.</p>

<p>In order to generate the hash, you append the salt to the user id,
and then run it through a one way hashing function. The result is a
unique key that can only be generated by the two parties who know
the salt (or generated by anyone who knows the salt, so make sure
the salt stays very secure). Since it is a one way function, it
would be very difficult for someone to reverse engineer it.</p>

<p>Now that we have the id and the hash explained, lets talk about how
bar.com can use this to authenticate the user. When a user on
Foo.com first logs in, the shared cookie is created by foo.com, and
when they hit a page in the iFrame which is pointing to bar.com,
bar.com checks the cookie. If it is there, it has the user id and
hash of the remote user.</p>

<p>Step one for bar.com is to take the user
id, hash it (based on the agreed upon salt), and first verify that
it matches the hash that is supplied as the second part of the
cookie. If it matches, it is safe for bar.com to assume the user id
in the cookie is the user id of the remote user, thus bar.com can
log the user in.</p>

<p>This method is not the most secure method of doing
a single sign on as a hacker can easily do a man in the middle
attack and thus obtain the cookie, and hash, and then with the user
id and hash in hand, can easily log in to bar.com as the remote
user.</p>

<p>There are a few precautions you can take if you choose to use
this method like adding values to the salt like, date, time,
request id, that would make the request unique not only to a user,
but to a specific time of day or a specific request. Another
approach you can take to make this more secure is to simply use SSL
across the wire.</p>

<p>Keep in mind we used this method as a simple way
of verifying user identity, we were not concerned with either site
getting hacked as we had other security mechanisms in place.</p>

<p>So, please take this approach with a grain of salt.</p>


        </div>

        

        
          
  <div class="page-comments">
    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function () {
        this.page.url = 'https://stevenlevine.dev/2008/10/a-little-salt-with-that-hash/';
        this.page.identifier = 'https://stevenlevine.dev/2008/10/a-little-salt-with-that-hash/';
      };

      (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://levine.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>


        

        <nav class="page-pagination" role="navigation">
  
    <a class="page-previous" href="/2008/09/webkit-day-25-benchmarks/">
      <h4 class="page-pagination-label">Previous</h4>
      <span class="page-pagination-title">
        <i class="fas fa-arrow-left"></i> WebKit Day 2.5 Benchmarks

      </span>
    </a>
  

  
    <a class="page-next" href="/2008/11/simple-security-for-http-based-restful-services-part-1/">
      <h4 class="page-pagination-label">Next</h4>
      <span class="page-pagination-title">
        Simple Security for HTTP Based RESTful Services (Part 1)
 <i class="fas fa-arrow-right"></i>
      </span>
    </a>
  
</nav>

      </div>
    </div>
  </article>
</main>


    <footer id="footer" class="site-footer">
  <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
<div class="social-icons"><a class="social-icon" href="/feed.xml"><i class="fas fa-rss-square fa-2x" title="Feed"></i></a></div><div class="copyright">
    
      <p>&copy; 2022 Steven Levine. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/mmistakes/so-simple-theme" rel="nofollow">So Simple</a>.</p>
    
  </div>
</footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script><script>
  if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-113658491-1', 'auto');
    ga('send', 'pageview');
  }
  </script>


  </body>

</html>
