<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>A little Salt with that Hash? &#8211; Steven Levine</title>
<meta name="description" content="">
<meta name="keywords" content="Development, Java">


<!-- Twitter Cards -->
<meta name="twitter:title" content="A little Salt with that Hash?">
<meta name="twitter:description" content="">
<meta name="twitter:site" content="@blue64">
<meta name="twitter:creator" content="@blue64">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blue64.net/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="A little Salt with that Hash?">
<meta property="og:description" content="">
<meta property="og:url" content="https://blue64.net/2008/10/a-little-salt-with-that-hash/">
<meta property="og:site_name" content="Steven Levine">





<link rel="canonical" href="https://blue64.net/2008/10/a-little-salt-with-that-hash/">
<link href="https://blue64.net/feed.xml" type="application/atom+xml" rel="alternate" title="Steven Levine Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="https://blue64.net/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="https://blue64.net/assets/js/vendor/html5shiv.min.js"></script>
  <script src="https://blue64.net/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="https://blue64.net/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>



<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
<!-- 32x32 -->
<link rel="shortcut icon" type="image/png" href="https://blue64.net/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://blue64.net/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://blue64.net/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://blue64.net/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blue64.net/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="https://blue64.net/about/" >About</a></li>
		  
		    
		    <li><a href="https://blue64.net/posts/" >Archives</a></li>
		  
		    
		    <li><a href="https://blue64.net/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
  		<a href="https://blue64.net/" class="site-logo" rel="home" title="Steven Levine"><img src="https://blue64.net/images/site-logo.png" width="200" height="200" alt="Steven Levine logo" class="animated fadeInDown"></a>
      
      <h1 class="site-title animated fadeIn"><a href="https://blue64.net/about">Steven Levine</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Hacker, Programmer, Cycling Geek, Scala Enthusiast, who is fascinated with Fast Data, Docker, Linux, and Information Security.</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
        Tags: &nbsp;&nbsp; <li><a href="https://blue64.net/tags/#Development" title="Pages tagged Development">Development</a></li><li><a href="https://blue64.net/tags/#Java" title="Pages tagged Java">Java</a></li>
        </ul>
        
          <h1 class="entry-title">A little Salt with that Hash?</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <a href="https://blue64.net/about"><img src="https://blue64.net/images/author.jpg" class="bio-photo" alt="Steven Levine bio photo"></a>
        
      <!-- <span class="author vcard">By <span class="fn">Steven Levine</span></span> -->
      <div class="social-icons">
      	<a href="https://twitter.com/blue64" title="Steven Levine on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
      	<a href="https://linkedin.com/in/levinesteve" title="Steven Levine on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
      	<a href="https://stackoverflow.com/users/63013/steven-levine" title="Steven Levine on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
      	<a href="https://github.com/slevine" title="Steven Levine on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
      </div>
        <span class="entry-date date published"><time datetime="2008-10-30T19:06:09-04:00"><i class="fa fa-calendar-o"></i> October 30, 2008</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=Development,Java&amp;text=A%20little%20Salt%20with%20that%20Hash?&amp;url=https://blue64.net/2008/10/a-little-salt-with-that-hash/&amp;via=blue64" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://blue64.net/2008/10/a-little-salt-with-that-hash/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=https://blue64.net/2008/10/a-little-salt-with-that-hash/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->

        
      </footer>
      <div class="entry-content">
        <p>Was just presented with a unique (to me) requirement which is to
implement a single sign on across multiple domains within the same
page via a cookie. Huh? Let me elaborate, in simple terms it means
that there is a base site, lets call it foo.com, and then there is
a partner site, lets call it bar.com. On foo.com’s main page we
want to be able to iFrame in bar.com with the credentials of the
current user logged in to foo.com transparently sent over and in
turn logged in to bar.com as well.</p>

<p>In order to achieve this, the
first thing that needs to happen is the two sites need to have a
sub domain in common. The easiest way to accomplish this is to set
up an alias on the parent site (foo.com) to bar.com. The alias
would be something like bar.foo.com which points to bar.com. This
is required because if they do not have a domain in common there is
no way for them to share cookies.</p>

<p>The next thing that needs to
happen is both sites have to agree on a way of authenticating a
user. In our case we used a cookie that consisted of the user id
followed by a hash of the user id which looked something like
<code class="highlighter-rouge">12345,jfk83jf835jfiie43</code>.</p>

<p>Your probably wondering how this simple
cookie can facility a single sign on across two different sites?
Let me explain, first lets talk about the how the values of the
cookie are generated. The first value, namely, the user id, is self
explanatory. The second part of the cookie, the hash, has a little
bit more to it. In order to effectively use the hash, the two sites
need to have a “shared secret” aka “The Salt” that only they know.</p>

<p>In order to generate the hash, you append the salt to the user id,
and then run it through a one way hashing function. The result is a
unique key that can only be generated by the two parties who know
the salt (or generated by anyone who knows the salt, so make sure
the salt stays very secure). Since it is a one way function, it
would be very difficult for someone to reverse engineer it.</p>

<p>Now that we have the id and the hash explained, lets talk about how
bar.com can use this to authenticate the user. When a user on
Foo.com first logs in, the shared cookie is created by foo.com, and
when they hit a page in the iFrame which is pointing to bar.com,
bar.com checks the cookie. If it is there, it has the user id and
hash of the remote user.</p>

<p>Step one for bar.com is to take the user
id, hash it (based on the agreed upon salt), and first verify that
it matches the hash that is supplied as the second part of the
cookie. If it matches, it is safe for bar.com to assume the user id
in the cookie is the user id of the remote user, thus bar.com can
log the user in.</p>

<p>This method is not the most secure method of doing
a single sign on as a hacker can easily do a man in the middle
attack and thus obtain the cookie, and hash, and then with the user
id and hash in hand, can easily log in to bar.com as the remote
user.</p>

<p>There are a few precautions you can take if you choose to use
this method like adding values to the salt like, date, time,
request id, that would make the request unique not only to a user,
but to a specific time of day or a specific request. Another
approach you can take to make this more secure is to simply use SSL
across the wire.</p>

<p>Keep in mind we used this method as a simple way
of verifying user identity, we were not concerned with either site
getting hacked as we had other security mechanisms in place.</p>

<p>So, please take this approach with a grain of salt.</p>


        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'levine'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="https://blue64.net/2008/09/webkit-day-25-benchmarks/" class="btn" title="WebKit Day 2.5 Benchmarks">Previous</a>
      
      
        <a href="https://blue64.net/2008/11/simple-security-for-http-based-restful-services-part-1/" class="btn" title="Simple Security for HTTP Based RESTful Services (Part 1)">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2019 Steven Levine. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/blue64" title="Steven Levine on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	<a href="https://linkedin.com/in/levinesteve" title="Steven Levine on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="https://stackoverflow.com/users/63013/steven-levine" title="Steven Levine on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
	
	
	<a href="https://github.com/slevine" title="Steven Levine on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="https://blue64.net/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'https://blue64.net';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://blue64.net/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="https://blue64.net/assets/js/scripts.min.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-113658491-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>
