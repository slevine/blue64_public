<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Simple Security for HTTP Based RESTful Services (Part 1) &#8211; Steven Levine</title>
<meta name="description" content="">
<meta name="keywords" content="Development, Java, REST">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Simple Security for HTTP Based RESTful Services (Part 1)">
<meta name="twitter:description" content="">
<meta name="twitter:site" content="@blue64">
<meta name="twitter:creator" content="@blue64">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blue64.net/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Simple Security for HTTP Based RESTful Services (Part 1)">
<meta property="og:description" content="">
<meta property="og:url" content="https://blue64.net/2008/11/simple-security-for-http-based-restful-services-part-1/">
<meta property="og:site_name" content="Steven Levine">





<link rel="canonical" href="https://blue64.net/2008/11/simple-security-for-http-based-restful-services-part-1/">
<link href="https://blue64.net/feed.xml" type="application/atom+xml" rel="alternate" title="Steven Levine Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="https://blue64.net/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="https://blue64.net/assets/js/vendor/html5shiv.min.js"></script>
  <script src="https://blue64.net/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="https://blue64.net/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>



<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
<!-- 32x32 -->
<link rel="shortcut icon" type="image/png" href="https://blue64.net/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://blue64.net/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://blue64.net/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://blue64.net/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blue64.net/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="https://blue64.net/about/" >About</a></li>
		  
		    
		    <li><a href="https://blue64.net/posts/" >Archives</a></li>
		  
		    
		    <li><a href="https://blue64.net/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
  		<a href="https://blue64.net/" class="site-logo" rel="home" title="Steven Levine"><img src="https://blue64.net/images/site-logo.png" width="200" height="200" alt="Steven Levine logo" class="animated fadeInDown"></a>
      
      <h1 class="site-title animated fadeIn"><a href="https://blue64.net/about">Steven Levine</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Hacker, Programmer, Cycling Geek, Scala Enthusiast, who is fascinated with Fast Data, Docker, Linux, and Information Security.</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
        Tags: &nbsp;&nbsp; <li><a href="https://blue64.net/tags/#Development" title="Pages tagged Development">Development</a></li><li><a href="https://blue64.net/tags/#Java" title="Pages tagged Java">Java</a></li><li><a href="https://blue64.net/tags/#REST" title="Pages tagged REST">REST</a></li>
        </ul>
        
          <h1 class="entry-title">Simple Security for HTTP Based RESTful Services (Part 1)</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <a href="https://blue64.net/about"><img src="https://blue64.net/images/author.jpg" class="bio-photo" alt="Steven Levine bio photo"></a>
        
      <!-- <span class="author vcard">By <span class="fn">Steven Levine</span></span> -->
      <div class="social-icons">
      	<a href="https://twitter.com/blue64" title="Steven Levine on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
      	<a href="https://linkedin.com/in/levinesteve" title="Steven Levine on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
      	<a href="https://stackoverflow.com/users/63013/steven-levine" title="Steven Levine on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
      	<a href="https://github.com/slevine" title="Steven Levine on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
      </div>
        <span class="entry-date date published"><time datetime="2008-11-29T19:58:50-05:00"><i class="fa fa-calendar-o"></i> November 29, 2008</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=Development,Java,REST&amp;text=Simple%20Security%20for%20HTTP%20Based%20RESTful%20Services%20(Part%201)&amp;url=https://blue64.net/2008/11/simple-security-for-http-based-restful-services-part-1/&amp;via=blue64" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://blue64.net/2008/11/simple-security-for-http-based-restful-services-part-1/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=https://blue64.net/2008/11/simple-security-for-http-based-restful-services-part-1/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->

        
      </footer>
      <div class="entry-content">
        <p>This is going to be the first in a series of posts discussing
potential ways of securing bi-directional RESTful based HTTP
services. For this series we are going to make the requirements
quite simple, namely, “secure” simply means the caller of the
service is authorized to invoke it. Lets assume that this solution
is being deployed along with a simple IP addresses restriction
mechanism. Since IP address’s can easily be spoofed, this solution
is the next level of defense to ensure the identity of the caller.</p>

<p>There are many different potential solutions to this problem, but
for this series, we are going to focus on the simplest solution
which is to add a security hash to each service call. This post
assumes you understand how to secure B2B communications with the
use of a security hash. If you need a refresher, please refer to
<a href="/2008/10/a-little-salt-with-that-hash/">this post</a>
on the subject.</p>

<p>Since we know the design for securing our
communications, we need to decide on an implementation. The first
potential implementation we are going to examine is adding a
“security hash” to the XML payload for each service call.</p>

<p>The embellished XML payload would look like:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;someEntity&gt;</span>
    <span class="nt">&lt;hash&gt;</span>4723af11bef05fc6207bd22cd163d9db<span class="nt">&lt;/hash&gt;</span>
    <span class="nt">&lt;fieldOne&gt;</span> ... <span class="nt">&lt;/fieldOne&gt;</span>
    <span class="nt">&lt;fieldTwo&gt;</span> ... <span class="nt">&lt;/fieldTwo&gt;</span>
<span class="nt">&lt;/someEntity&gt;</span>
</code></pre></div></div>

<p>with the “hash” field (line 2) representing the security hash.</p>

<p>The interface of the SomeEntity service, would look like:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SomeEntityService</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateSomeEntity</span><span class="o">(</span><span class="n">SomeEntity</span> <span class="n">entity</span><span class="o">,</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">SecurityException</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>with an implementation that looks like:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Path</span><span class="o">(</span><span class="s">"/services"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SomeEntityServiceImpl</span> <span class="o">{</span>

    <span class="nd">@PUT</span>
    <span class="nd">@Path</span><span class="o">(</span><span class="s">"/someEntity/{id}"</span><span class="o">)</span>
    <span class="nd">@Consumes</span><span class="o">(</span><span class="s">"text/xml"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateSomeEntity</span><span class="o">(</span><span class="n">SomeEntity</span> <span class="n">entity</span><span class="o">,</span>
                    <span class="nd">@PathParam</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span>
                        <span class="kd">throws</span> <span class="n">SecurityException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">validateHash</span><span class="o">(</span><span class="n">entity</span><span class="o">))</span>
            <span class="n">dao</span><span class="o">.</span><span class="na">saveOrupdate</span><span class="o">(</span><span class="n">entity</span><span class="o">)</span>
        <span class="k">else</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="s">"Not Authorized"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>With the actual HTTP Client call looking like:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PUT http://blah.com/services/someEntity/226 HTTP/1.1
Accept: text/xml
Content-Type: text/xml
User-Agent: Jakarta Commons-HttpClient/3.1
Host: somehost:port
Content-Length: 380
<span class="nt">&lt;someEntity&gt;</span>
    <span class="nt">&lt;hash&gt;</span>4723af11bef05fc6207bd22cd163d9db<span class="nt">&lt;/hash&gt;</span>
    <span class="nt">&lt;fieldOne&gt;</span> fieldOne <span class="nt">&lt;/fieldOne&gt;</span>
    <span class="nt">&lt;fieldTwo&gt;</span> fieldTwo <span class="nt">&lt;/fieldTwo&gt;</span>
<span class="nt">&lt;/someEntity&gt;</span>
</code></pre></div></div>

<p>There you have it, our first potential solution to the
problem. We now need to examine if this solution is correct, and if
it is, is it elegant?</p>

<p>First things first, is it correct? If you
trace through the code, you can see that before the service makes a
call to the DAO, it checks to verify the validity of the hash field
(line 10). If the hash it is not valid, it will throw an Exception,
which in turn would return a 401 to the user. It would not be
possible for a client to access the DAO without having the proper
hash as part of the XML Payload.</p>

<p>Even though this approach would
perform as expected, it has two main issues, the first being it
mixes concerns. What we mean by mixes concerns is it mixes business
logic with security logic. This is a standard problem that applies
to layered architectures. The main side effect of this problem is
it makes the code very difficult to reuse. Lets me demonstrate this
with a simple code fragment:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Code in a Web Controller class somewhere</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">someEntitySvc</span><span class="o">.</span><span class="na">updateSomeEntity</span><span class="o">(</span><span class="n">entity</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Nothing we can do... We don't have the hash???</span>
<span class="o">}</span>
</code></pre></div></div>

<p>As you can see from this simple example the implementation of the
service is not generic enough to be usable by a Controller in the
Web Tier. Firstly, even if the Web Tier knew about he hash, the
code becomes polluted with Exception handling for an Exception that
is not applicable to this client. Secondly, the Web Tier simply
doesn’t have any knowledge of the hash, and putting logic here to
generate the hash just to use the service would not make any sense
from a design perspective.</p>

<p>The second issue with this approach is
the fact that you can only apply it to Http methods that accept a
payload. What about methods that do not accept a Payload, I.e.,
GET? To make this work for the GET method, we would have to pollute
our GET method implementation with a @Consumes(“text/xml”) tag,
which functionally would work, but from a API design perspective,
it is quite ugly. As a consumer of a GET method, all you need to
know is the id of the entity you wish to “get”. Adding an XML
payload for “security” purposes is a bad and cumbersome design.</p>

<p>With all that being said, it looks like this is not the best
solution to the problem. Stay tuned for part two of this series
where we will discuss a more elegant approach to solving this
problem.</p>


        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'levine'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="https://blue64.net/2008/10/a-little-salt-with-that-hash/" class="btn" title="A little Salt with that Hash?">Previous</a>
      
      
        <a href="https://blue64.net/2008/12/simple-security-for-http-based-restful-services-part-2/" class="btn" title="Simple Security for HTTP Based RESTful Services (Part 2)">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2019 Steven Levine. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/blue64" title="Steven Levine on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	<a href="https://linkedin.com/in/levinesteve" title="Steven Levine on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="https://stackoverflow.com/users/63013/steven-levine" title="Steven Levine on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
	
	
	<a href="https://github.com/slevine" title="Steven Levine on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="https://blue64.net/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'https://blue64.net';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://blue64.net/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="https://blue64.net/assets/js/scripts.min.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-113658491-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>
