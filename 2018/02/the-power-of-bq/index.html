<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>The Power of Big Query with Public Data &#8211; Steven Levine</title>
<meta name="description" content="If you are looking for an easy way to query a public dataset you should definitely check out Big Query's publicly available datasets.">
<meta name="keywords" content="Development, Database">


<!-- Twitter Cards -->
<meta name="twitter:title" content="The Power of Big Query with Public Data">
<meta name="twitter:description" content="If you are looking for an easy way to query a public dataset you should definitely check out Big Query's publicly available datasets.">
<meta name="twitter:site" content="@blue64">
<meta name="twitter:creator" content="@blue64">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blue64.net/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="The Power of Big Query with Public Data">
<meta property="og:description" content="If you are looking for an easy way to query a public dataset you should definitely check out Big Query's publicly available datasets.">
<meta property="og:url" content="https://blue64.net/2018/02/the-power-of-bq/">
<meta property="og:site_name" content="Steven Levine">





<link rel="canonical" href="https://blue64.net/2018/02/the-power-of-bq/">
<link href="https://blue64.net/feed.xml" type="application/atom+xml" rel="alternate" title="Steven Levine Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="https://blue64.net/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="https://blue64.net/assets/js/vendor/html5shiv.min.js"></script>
  <script src="https://blue64.net/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="https://blue64.net/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>



<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
<!-- 32x32 -->
<link rel="shortcut icon" type="image/png" href="https://blue64.net/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://blue64.net/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://blue64.net/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://blue64.net/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blue64.net/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="https://blue64.net/about/" >About</a></li>
		  
		    
		    <li><a href="https://blue64.net/posts/" >Archives</a></li>
		  
		    
		    <li><a href="https://blue64.net/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
  		<a href="https://blue64.net/" class="site-logo" rel="home" title="Steven Levine"><img src="https://blue64.net/images/site-logo.png" width="200" height="200" alt="Steven Levine logo" class="animated fadeInDown"></a>
      
      <h1 class="site-title animated fadeIn"><a href="https://blue64.net/about">Steven Levine</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Hacker, Programmer, Cycling Geek, Scala Enthusiast, who is fascinated with Fast Data, Docker, Linux, and Information Security.</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
        Tags: &nbsp;&nbsp; <li><a href="https://blue64.net/tags/#Development" title="Pages tagged Development">Development</a></li><li><a href="https://blue64.net/tags/#Database" title="Pages tagged Database">Database</a></li>
        </ul>
        
          <h1 class="entry-title">The Power of Big Query with Public Data</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <a href="https://blue64.net/about"><img src="https://blue64.net/images/author.jpg" class="bio-photo" alt="Steven Levine bio photo"></a>
        
      <!-- <span class="author vcard">By <span class="fn">Steven Levine</span></span> -->
      <div class="social-icons">
      	<a href="https://twitter.com/blue64" title="Steven Levine on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
      	<a href="https://linkedin.com/in/levinesteve" title="Steven Levine on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
      	<a href="https://stackoverflow.com/users/63013/steven-levine" title="Steven Levine on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
      	<a href="https://github.com/slevine" title="Steven Levine on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
      </div>
        <span class="entry-date date published"><time datetime="2018-02-04T17:03:00-05:00"><i class="fa fa-calendar-o"></i> February 04, 2018</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=Development,Database&amp;text=The%20Power%20of%20Big%20Query%20with%20Public%20Data&amp;url=https://blue64.net/2018/02/the-power-of-bq/&amp;via=blue64" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://blue64.net/2018/02/the-power-of-bq/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=https://blue64.net/2018/02/the-power-of-bq/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->

        
      </footer>
      <div class="entry-content">
        <blockquote>
  <p>TLDR — If you are looking for an easy way to query a public dataset, you should definitely check out Big Query’s publicly available datasets, and chances are you will find the dataset you are looking for.</p>
</blockquote>

<h3 id="background">Background</h3>

<p>Late one Sunday afternoon, I found myself browsing around a few high profile JVM projects on GitHub and noticed that they all used different build tools.  The build tools were spread across Gradle, Maven, and SBT.  After seeing this, started wondering what the actual distribution was for the different build tools on GitHub.  Cleary, won’t be able to click my way through enough repos to get a clear respresentation, so I had to figure out a way to find some hard numbers to answer my question.</p>

<h3 id="first-attempt">First Attempt</h3>

<p>The first place where I tried to answer this simple question was to use the <a href="https://github.com/search?q=pom.xml&amp;type=Code&amp;utf8=%E2%9C%93">Github search box</a>.  After trying different combinations and even within the advanced search, found it really difficult to get the results because of too much noise.  The main problem was that when searching for <code class="highlighter-rouge">pom.xml</code> the place it showed up most often was in <code class="highlighter-rouge">.gitignore</code> which was not really relevant to my question.  This itself seemed a bit strange to me, as why would projects not want to version control their build artifacts?  Is the  <code class="highlighter-rouge">pom.xml</code> being generated as part of the build itself?  Will leave these interesting questions for another afternoon.</p>

<h3 id="the-solution">The Solution</h3>

<p>Soon after this, I remembered that <a href="https://cloud.google.com/bigquery/">Big Query</a> has <a href="https://cloud.google.com/bigquery/public-data/">public datasets</a> available for all to use <em>(for free)</em>, and decdied to take a quick peek to see if the <a href="https://cloud.google.com/bigquery/public-data/github">GitHub dataset</a> was there, and sure enough, it was. Great.  After some exploring around the <code class="highlighter-rouge">github_repos</code> dataset, was able to find a table called <code class="highlighter-rouge">files</code> which looked very promising because it should have one row per file in GitHub right?  This should allow me to write a query that looked for the specific build files located wihin a project and then do a simple count.  After a quick browse around the tables, was able to find the <em>files</em> table and it had the following shape:</p>

<table>
  <tbody>
    <tr>
      <td>repo_name</td>
      <td>STRING</td>
      <td>NULLABLE</td>
    </tr>
    <tr>
      <td>ref</td>
      <td>STRING</td>
      <td>NULLABLE</td>
    </tr>
    <tr>
      <td>path</td>
      <td>STRING</td>
      <td>NULLABLE</td>
    </tr>
    <tr>
      <td>mode</td>
      <td>INTEGER</td>
      <td>NULLABLE</td>
    </tr>
    <tr>
      <td>id</td>
      <td>STRING</td>
      <td>NULLABLE</td>
    </tr>
    <tr>
      <td>symlink_target</td>
      <td>STRING</td>
      <td>NULLABLE</td>
    </tr>
  </tbody>
</table>

<p>After some simple data exploration was able to get a good idea of the meaning of the data with the following query:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="p">[</span><span class="n">bigquery</span><span class="o">-</span><span class="k">public</span><span class="o">-</span><span class="k">data</span><span class="p">:</span><span class="n">github_repos</span><span class="p">.</span><span class="n">files</span><span class="p">]</span> <span class="k">where</span> <span class="n">path</span> <span class="o">=</span> <span class="s1">'build.sbt'</span> <span class="k">LIMIT</span> <span class="mi">2</span>
</code></pre></div></div>

<p>yielding:</p>

<table>
  <thead>
    <tr>
      <th>Row</th>
      <th>repo_name</th>
      <th>ref</th>
      <th>path</th>
      <th>mode</th>
      <th>id</th>
      <th>symlink_target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Knewton/kafka-manager</td>
      <td>refs/heads/master</td>
      <td>build.sbt</td>
      <td>33188</td>
      <td>934503…</td>
      <td>null</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Radsaggi/zipkin</td>
      <td>refs/heads/master</td>
      <td>build.sbt</td>
      <td>33188</td>
      <td>634bab3…</td>
      <td>null</td>
    </tr>
  </tbody>
</table>

<p>Clearly this looks like the right table to use to answer my question about counting the different build tool usages.</p>

<p>The next step was to come up with a query that can count the instances of each build artifact, meaning, count the number of  <code class="highlighter-rouge">build.gradle</code>, <code class="highlighter-rouge">build.sbt</code>, and <code class="highlighter-rouge">pom.xml</code> across the Github dataset.  The results should give a good indication of how many projects use each build tool.</p>

<p>Here is that query:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">sbt</span><span class="p">.</span><span class="n">cnt</span><span class="p">,</span> <span class="n">gradle</span><span class="p">.</span><span class="n">cnt</span><span class="p">,</span> <span class="n">maven</span><span class="p">.</span><span class="n">cnt</span>
<span class="k">FROM</span>
  <span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">cnt</span> <span class="k">FROM</span> <span class="p">[</span><span class="n">bigquery</span><span class="o">-</span><span class="k">public</span><span class="o">-</span><span class="k">data</span><span class="p">:</span><span class="n">github_repos</span><span class="p">.</span><span class="n">files</span><span class="p">]</span> <span class="k">where</span> <span class="n">path</span> <span class="o">=</span> <span class="s1">'build.sbt'</span><span class="p">)</span> <span class="n">sbt</span>
<span class="k">CROSS</span> <span class="k">JOIN</span>
  <span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">cnt</span> <span class="k">FROM</span> <span class="p">[</span><span class="n">bigquery</span><span class="o">-</span><span class="k">public</span><span class="o">-</span><span class="k">data</span><span class="p">:</span><span class="n">github_repos</span><span class="p">.</span><span class="n">files</span><span class="p">]</span> <span class="k">where</span> <span class="n">path</span> <span class="o">=</span> <span class="s1">'pom.xml'</span><span class="p">)</span> <span class="n">maven</span>
<span class="k">CROSS</span> <span class="k">JOIN</span>
  <span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">cnt</span> <span class="k">FROM</span> <span class="p">[</span><span class="n">bigquery</span><span class="o">-</span><span class="k">public</span><span class="o">-</span><span class="k">data</span><span class="p">:</span><span class="n">github_repos</span><span class="p">.</span><span class="n">files</span><span class="p">]</span> <span class="k">where</span> <span class="n">path</span> <span class="o">=</span> <span class="s1">'build.gradle'</span><span class="p">)</span> <span class="n">gradle</span>
</code></pre></div></div>

<p>which yielded the following results:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Row</th>
      <th style="text-align: left">sbt_cnt</th>
      <th style="text-align: left">gradle_cnt</th>
      <th style="text-align: left">maven_cnt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">15,628</td>
      <td style="text-align: left">91,528</td>
      <td style="text-align: left">116,535</td>
    </tr>
  </tbody>
</table>

<p>There you have it, based on the data in this dataset, Maven out numbers SBT and Gradle. <sup><a href="#dataFootnote1">1</a></sup>  If I was going to take this experiemnt to the next level, I would take this data and join it with the repository’s most prevalent language, meaning, Java, Scala, etc.. to be able to say which build tool is most often used for which language.</p>

<blockquote>
  <p>The great thing about using Big Query with public datasets is the fact that there is no ETL required.</p>
</blockquote>

<p>If you are looking for an easy way to query a public dataset, you should definitely check out Big Query’s publicly available datasets, and chances are you will find the dataset you are looking for.  The great thing about using Big Query with public datasets is the fact that there is no ETL required. The only<sup><a href="#dataFootnote2">2</a></sup> thing required to run a query against a public dataset is to head to the <a href="https://bigquery.cloud.google.com">Big Query Console</a>, pick a dataset, type in the query, and within seconds you will have results to review.</p>

<p>What are you waiting for?</p>

<h5 id="notes">Notes</h5>

<p><a name="dataFootnote1">1</a><em>: According to the meta data on the files table, it hasn’t been touched since Nov 2, 2017 so this data is a bit old.  Also keep in mind, that was is a very un-scientific way of figuring out build tool usage, thus take these numbers for what they are, a fun weekend experiement.</em></p>

<p><a name="dataFootnote2">2</a><em>: Signing up for a Free GCP account is required to gain access to the Big Query Console, although a Credit Card is not required to run queries.  However, there is a relatively low quota in place if you do not provide a credit card.</em></p>

        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'levine'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="https://blue64.net/2013/12/notes-from-a-talk-on-evolving-java/" class="btn" title="Notes from a Talk on Evolving Java">Previous</a>
      
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2019 Steven Levine. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/blue64" title="Steven Levine on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	<a href="https://linkedin.com/in/levinesteve" title="Steven Levine on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="https://stackoverflow.com/users/63013/steven-levine" title="Steven Levine on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
	
	
	<a href="https://github.com/slevine" title="Steven Levine on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="https://blue64.net/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'https://blue64.net';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://blue64.net/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="https://blue64.net/assets/js/scripts.min.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-113658491-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>
